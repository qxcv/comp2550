<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">

        <title>Particle Filters for Map-Based Localisation</title>

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/serif.css" id="theme">

        <!-- Code syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->

        <style>
            .reveal .inline-fig {
                display: inline-block !important;
            }

            .reveal figcaption {
                font-size: 0.8em;
            }

            .reveal .credits {
                font-size: 0.6em;
            }

            .reveal #map-filter, .reveal #plain-filter {
                display: inline-block;
                margin: none;
                padding: none;
                outline: 0;
            }

            .reveal .coloured {
                text-shadow: 0px 0px 3px black;
            }

            .reveal .red {
                color: red;
            }

            .reveal .blue {
                color: blue;
            }

            .reveal .green {
                color: green;
            }
        </style>
    </head>

    <body>
        <div class="reveal">
            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section>
                    <h2>Particle Filters for Map-Based Localisation</h2>
                    <p>
                        <small>Sam Toyer</small>
                        <br>
                        <small><small>
                            <a href="mailto:sam@qxcv.net">
                                <code>sam@qxcv.net</code>
                            </a>
                        </small></small>
                    </p>
                </section>

                <section>
                    <h3>Localisation</h3>
                    <p>Localisation is the task of determining your position
                    within an environment given a series of sensor
                    observations. <strong>Extremely</strong> important task for
                    road vehicles.</p>

                    <figure class=inline-fig>
                        <img
                            src="images/tomtom.jpg"
                            alt="Hand-held GPS unit" height=200px>
                    </figure>

                    <figure class=inline-fig>
                        <img
                            src="images/hands-free-driving.jpg"
                            alt="Autonomous car" height=200px>
                    </figure>
                </section>

                <section>
                    <h3>Real world localisation is messy</h3>
                    <ul>
                        <li>GPS is unreliable</li>
                        <li>Dead reckoning drifts</li>
                        <li>More complex methods can be impractical</li>
                    </ul>

                    <figure style="float: right;">
                        <img
                            style="width: 350px;"
                            src=images/drawil-et-al.png
                            alt="Inaccurate GPS traces overlayed on a road network">
                        <figcaption>
                            <em>
                                GPS Localization Accuracy Classification: A
                                Context-Based Approach
                            </em> (Drawil et al., 2013)
                        </figcaption>
                    </figure>
                </section>

                <section>
                    <h3>Improving the situation with maps</h3>
                    <ol>
                        <li>
                            Cars are on the road most of the time
                        </li>
                        <li>
                            Detailed road maps are easy to find
                        </li>
                    </ol>
                    <p>
                        <strong>
                            How can we use this information to improve
                            localisation?
                        </strong>
                    </p>
                </section>

                <section>
                    <section>
                        <h3>Existing approaches</h3>
                        <p>
                            Two broad families of &ldquo;map matching&rdquo;
                            algorithms: heuristic and probabilistic
                        </p>
                    </section>
                    <section>
                        <p>
                            <strong>Heuristic methods</strong> use
                            hand-coded rules to rule out unlikely vehicle
                            positions
                            <figure>
                                <blockquote>
                                    <ul>
                                        <li>
                                            If ($\Delta \theta$) is small) and
                                            ($\alpha$ is below 90&deg;) and
                                            ($\beta$ is below 90&deg;) then (L2
                                            is high)
                                        </li>
                                        <li>
                                            If ($\Delta \theta$) is small) and
                                            ($\Delta d$ is positive) and
                                            ($\alpha$ is above 90&deg;) then (L2
                                            is low)
                                        </li>
                                        <li>
                                            If ($\Delta \theta$) is small) and
                                            ($\Delta d$ is positive) and
                                            ($\beta$ is above 90&deg;) then (L2
                                            is low)
                                        </li>
                                        <li>&hellip;</li>
                                    </ul>
                                </blockquote>
                                <figcaption>
                                    <em>
                                        A high accuracy fuzzy logic based
                                        map matching algorithm for road
                                        transport
                                    </em> (Quddus et al., 2006)
                                </figcaption>
                            </figure>
                        </p>
                    </section>

                    <section>
                        <p>
                            <strong>Probabilistic methods</strong> represent
                            vehicle's position as a probability distribution
                            over locations
                        </p>

                        <figure>
                            <img
                                src=images/brubaker-et-al.png
                                alt="Probability distribution over vehicle positions being narrowed down by Brubaker et al.'s algorithm">
                            <figcaption>
                                <em>
                                    Lost! leveraging the crowd for
                                    probabilistic visual
                                    self-localization
                                </em> (Brubaker et al., 2013)
                            </figcaption>
                        </figure>

                        <p>
                            <strong>Particle filtering</strong> is a common
                            probabilistic method
                        </p>
                    </section>
                </section>

                <section>
                    <h3>Project goals</h3>

                    <ol>
                        <li>
                            Produce robust map-based localisation algorithm which is
                            robust to sensor noise
                        </li>
                        <li>
                            Investigate performance of particle filters with
                            &ldquo;consumer grade&rdquo; equipment and map data
                        </li>
                    </ol>
                </section>

                <section>
                    <section>
                        <h3>Particle filters: intuition</h3>

                        <p>
                            Particle filters represent vehicle's position using
                            large number of &ldquo;particles&rdquo;
                        </p>

                        <ol>
                            <li>
                                When vehicle moves, particles move
                            </li>
                            <li>
                                Introduce &ldquo;weights&rdquo; representing
                                particle likelihood
                            </li>
                            <li>
                                Focus on high-weight particles
                            </li>
                        </ol>
                    </section>

                    <section>
                        <figure style="float: right">
                            <img style="float: right;" src=images/rhino.jpg
                                 alt="Picture of RHINO">
                        </figure>

                        <p>
                            <strong>Example:</strong>
                            <em>Monte Carlo Localization: Efficient Position
                            Estimation for Mobile Robots</em>
                            (Fox et al., 1999)
                        </p>

                        <!--
                            NOTE: In a later paper, the same localisation
                            diagrams were presented as being from Minerva rather
                            than RHINO. Think that it was actually RHINO (an RWI
                            B21 robot), since the diagram itself was attributed
                            to an RWI B21, but Minerva was an RWI B18
                        -->

                        <p>
                            RHINO (pictured) used:
                        </p>

                        <ul>
                            <li>Sonar sensors</li>
                            <li>Laser range finders</li>
                            <li>Odometer</li>
                            <li>Environment map</li>
                        </ul>
                    </section>

                    <section>
                        <img src=images/fox-et-al-1.png
                            alt="Initialisation of the particle filter">
                        <figcaption>
                            Initially, particles spread out uniformly
                        </figcaption>
                    </section>

                    <section>
                        <img src=images/fox-et-al-2.png
                            alt="Bimodal particle distribution">
                        <figcaption>
                            Robot turns, detects corridor
                        </figcaption>
                    </section>

                    <section>
                        <img src=images/fox-et-al-3.png
                            alt="Particle filter converged">
                        <figcaption>
                            Correct position identified
                        </figcaption>
                    </section>
                </section>

                <section>
                    <section>
                        <h3>How does it work?</h3>

                        <p>
                            <em>Sequential importance resampling</em> approach,
                            outlined by Fox et al.
                        </p>

                        <p>Each particle $s_t^{(i)}$ is a sample from</p>

                        <p>\[
                            p(s_t \mid o_t, a_{t-1}, o_{t-1}, a_{t-2} \ldots, o_0)
                        \]</p>

                        <p>Where, at time $t$:</p>

                        <ul>
                            <li>$s_t$ is the state</li>
                            <li>$o_t$ denotes the observations</li>
                            <li>$a_t$ denotes actions</li>
                        </ul>
                    </section>

                    <section>
                        <p>Take action $a_t$ at time $t$, produces state
                        $s_{t+1}$ and sensor measurements $o_{t+1}$</p>

                        <ol>
                            <li>
                                <strong>Predict:</strong> move each particle
                                according to odometry

                                \[
                                    {s_t^{(i)}}' \sim p(s_{t+1} \mid s_t=s_t^{(i)}, a_t)
                                \]
                            </li>
                            <li>
                                <strong>Update:</strong> weight particles by
                                observation likelihood

                                \[
                                    w_t^{(i)} = p(o_{t+1} \mid s_t)
                                \]
                            </li>
                            <li>
                                <strong>Resample:</strong> choose new particles
                                $s_{t+1}^{(i)}$ from $\{{s_t^{(1)}}', \ldots,
                                {s_t^{(m)}}'\}$ using $w_t^{(i)}$
                            </li>
                        </ol>
                    </section>

                    <section data-transition=none>
                        <figure>
                            <img src=images/pf-1.png
                                alt="Particle filter initialisation">
                            <figcaption>
                                Particles initialised around $x = 0$
                            </figcaption>
                        </figure>
                    </section>

                    <section data-transition=none>
                        <figure>
                            <img src=images/pf-2.png
                                alt="Particle filter initialisation">
                            <figcaption>
                                Robot moves to $x = 1$
                            </figcaption>
                        </figure>
                    </section>

                    <section data-transition=none>
                        <figure>
                            <img src=images/pf-3.png
                                alt="Particle filter initialisation">
                            <figcaption>
                                <strong>Predict:</strong> Robot predicts particle positions $ $
                            </figcaption>
                        </figure>
                    </section>

                    <section data-transition=none>
                        <figure>
                            <img src=images/pf-4.png
                                alt="Particle filter initialisation">
                            <figcaption>
                                <strong>Update:</strong> Robot makes observation $ $
                            </figcaption>
                        </figure>
                    </section>

                    <section data-transition=none>
                        <figure>
                            <img src=images/pf-5.png
                                alt="Particle filter initialisation">
                            <figcaption>
                                <strong>Resample:</strong> Particles resampled by weight $ $
                            </figcaption>
                        </figure>
                    </section>
                </section>

                <section>
                    <h3>Incorporating map data</h3>
                </section>

                <section>
                    <h3>Complete algorithm</h3>
                </section>

                <section>
                    <h3>Demonstration (2x real time)</h3>

                    <figure class=inline-fig>
                        <video width=450
                            id=map-filter src=videos/map-filter.webm>
                        </video>
                        <figcaption>
                            Particle filtering with map data
                        </figcaption>
                    </figure>

                    <figure class=inline-fig>
                        <video width=450
                            id=plain-filter src=videos/plain-filter.webm>
                        </video>
                        <figcaption>
                            Particle filtering without map data
                        </figcaption>
                    </figure>

                    <p>
                        Both filters using noisy odometry at 10Hz and
                        positioning data with zero-mean Gaussian noise at 1Hz.
                    </p>

                    <!--
                    <p>
                        <span class="coloured green">Green</span> triangle is
                        ground truth, <span class="coloured blue">blue</span>
                        triangle is estimate, <span class="coloured
                            red">red</span> circles are particles, <span
                            class="coloured red">red</span> crosses are GPS
                        fixes
                    </p>
                    -->

                    <p>
                        <small>
                            Source: <a
                                href="https://github.com/qxcv/comp2550/">
                                github.com/qxcv/comp2550
                            </a>
                        </small>
                    </p>

<script>
var vid1 = document.getElementById("map-filter");
var vid2 = document.getElementById("plain-filter");
vid1.playbackRate = vid2.playbackRate = 2;

function sync(master, slave) {
    return function() {
        vid1.playbackRate = vid2.playbackRate = 2;
        if (!master.paused) {
            slave.currentTime = master.currentTime;
            slave.play();
        } else {
            slave.pause();
        }
    }
}

function clickHandler() {
    if (vid1.paused) {
        vid1.play();
    } else {
        vid1.pause();
    }
}

vid1.addEventListener('playing', sync(vid1, vid2));
vid1.addEventListener('pause', sync(vid1, vid2));
vid1.addEventListener('seeked', sync(vid1, vid2));
vid1.addEventListener('ended', sync(vid1, vid2));
vid1.addEventListener('click', clickHandler);
vid2.addEventListener('click', clickHandler);
</script>
                </section>

                <section>
                    <h3>Challenges</h3>

                    <p>What I haven't covered in this talk:</p>

                    <ul>
                        <li>
                            Missing odometry data
                        </li>
                        <li>
                            Priors on motion
                        </li>
                        <li>
                            Bimodal particle distributions
                        </li>
                        <li>
                            Correcting the map
                        </li>
                    </ul>
                </section>

                <section>
                    <h3>Image credits</h3>
                    <p><small>In order of appearance:</small></p>
                    <dl class=credits>
                        <dt>&ldquo;TomTom&rdquo;</dt>
                        <dd>
                            <a href="https://flic.kr/p/7d9qnS">Tom Haller</a>
                            on Flickr, CC-BY
                        </dd>
                        <dt>&ldquo;Hands-free Driving&rdquo;</dt>
                        <dd>
                            <a href="https://flic.kr/p/7apCYV">Steve
                            Jurvetson</a> on Flickr, CC-BY
                        </dd>
                        <dt>GPS accuracy illustration</dt>
                        <dd>
                            From N.M. Drawil, H.M. Amar and O.A. Basir, <em>GPS
                            Localization Accuracy Classification: A
                            Context-Based Approach</em> (IEEE ITS, 2013)
                        </dd>
                        <dt>Probabilistic localisation graphic</dt>
                        <dd>
                            From M.A. Brubaker, A. Geiger and R. Urtasun, <em>Lost!
                            Leveraging the Crowd for Probabilistic Visual
                            Self-Localization</em> (CVPR '13)
                        </dd>
                        <dt>Portrait of RHINO</dt>
                        <dd>
                            <a href="http://www.iai.uni-bonn.de/~rhino/tourguide/html/rhino-me.html">
                                Wolfram Burgard
                            </a> at the University of Bonn
                        </dd>
                        <dt>Particle filtering diagrams</dt>
                        <dd>
                            From D. Fox, W. Burgard, F. Dellaert and S. Thrun,
                            <em>Monte Carlo Localization: Efficient Position
                            Estimation for Mobile Robots</em> (AAAI '99)
                        </dd>
                        <dt>&ldquo;Robot with a claw&rdquo;</dt>
                        <dd>
                            <a href="https://openclipart.org/detail/21684/robot-with-a-claw">
                                Silveira_Neto
                            </a> on openclipart.org
                        </dd>
                    </dl>
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/math/math.js', async: true }
                ]
            });
        </script>
    </body>
</html>
